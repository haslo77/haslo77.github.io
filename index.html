<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PocketOption AI</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #1a1f35 0%, #0f1420 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: #1e2535;
            border-radius: 24px;
            padding: 32px;
            max-width: 480px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
        }

        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 32px;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #7ba7ff 0%, #a4c4ff 100%);
            border-radius: 12px;
        }

        .title-section h1 {
            color: #ffffff;
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 2px;
        }

        .title-section p {
            color: #8892a6;
            font-size: 13px;
        }

        .lang-badge {
            background: #2a3142;
            color: #ffffff;
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            user-select: none;
        }

        .lang-badge:hover {
            background: #353d52;
            transform: translateY(-1px);
        }

        .field {
            background: #151a28;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 16px;
        }

        .field-label {
            color: #8892a6;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .field-value {
            color: #ffffff;
            font-size: 18px;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .field-value.placeholder {
            color: #4a5568;
        }

        /* Custom Select */
        .custom-select {
            position: relative;
        }

        .select-trigger {
            width: 100%;
            background: linear-gradient(135deg, #2a3142 0%, #232938 100%);
            color: #ffffff;
            border: 2px solid #3a4560;
            border-radius: 12px;
            padding: 14px 16px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }

        .select-trigger:hover {
            border-color: #7ba7ff;
            background: linear-gradient(135deg, #2f3647 0%, #272d3d 100%);
        }

        .select-trigger.active {
            border-color: #7ba7ff;
            box-shadow: 0 0 0 3px rgba(123, 167, 255, 0.1);
        }

        .select-arrow {
            width: 20px;
            height: 20px;
            transition: transform 0.3s ease;
        }

        .select-trigger.active .select-arrow {
            transform: rotate(180deg);
        }

        .select-dropdown {
            position: absolute;
            top: calc(100% + 8px);
            left: 0;
            right: 0;
            background: #1e2535;
            border: 2px solid #3a4560;
            border-radius: 12px;
            max-height: 280px;
            overflow-y: auto;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .select-dropdown.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .select-option {
            padding: 14px 16px;
            cursor: pointer;
            transition: all 0.2s ease;
            color: #ffffff;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .select-option:hover {
            background: linear-gradient(90deg, rgba(123, 167, 255, 0.15) 0%, transparent 100%);
        }

        .select-option.selected {
            background: linear-gradient(90deg, rgba(123, 167, 255, 0.2) 0%, transparent 100%);
            color: #7ba7ff;
        }

        .select-option.auto {
            color: #a4c4ff;
            font-weight: 600;
            border-bottom: 1px solid #2a3142;
        }

        .option-icon {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: linear-gradient(135deg, #7ba7ff 0%, #a4c4ff 100%);
        }

        .select-dropdown::-webkit-scrollbar {
            width: 6px;
        }

        .select-dropdown::-webkit-scrollbar-track {
            background: #151a28;
            border-radius: 10px;
        }

        .select-dropdown::-webkit-scrollbar-thumb {
            background: #3a4560;
            border-radius: 10px;
        }

        .select-dropdown::-webkit-scrollbar-thumb:hover {
            background: #4a5570;
        }

        .button {
            width: 100%;
            padding: 16px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 12px;
            display: inline-flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
        }

        .button-primary {
            background: #7ba7ff;
            color: #1e2535;
        }

        .button-primary:hover:not(:disabled) {
            background: #a4c4ff;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(123, 167, 255, 0.3);
        }

        .button-primary:disabled {
            background: #3a4560;
            color: #5a6580;
            cursor: not-allowed;
        }

        .button-secondary {
            background: #2a3142;
            color: #ffffff;
        }

        .button-secondary:hover {
            background: #353d52;
        }

        .timer-badge {
            background: #2a3142;
            color: #ffffff;
            padding: 6px 10px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            min-width: 78px;
            justify-content: center;
        }

        .timer-icon {
            width: 12px;
            height: 12px;
        }

        /* spinner for loading */
        .spinner {
            border: 2px solid rgba(255,255,255,0.18);
            border-top-color: #ffffff;
            border-radius: 50%;
            width: 14px;
            height: 14px;
            animation: spin 1s linear infinite;
            display: inline-block;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        @media (max-width: 600px) {
            .container {
                padding: 24px;
            }

            .header {
                margin-bottom: 24px;
            }

            .logo {
                width: 40px;
                height: 40px;
            }

            .title-section h1 {
                font-size: 18px;
            }

            .title-section p {
                font-size: 12px;
            }

            .field-value {
                font-size: 16px;
            }

            .button {
                padding: 14px;
                font-size: 15px;
            }
        }

        @media (max-width: 400px) {
            body {
                padding: 12px;
            }

            .container {
                padding: 20px;
            }

            .title-section h1 {
                font-size: 16px;
            }

            .field {
                padding: 14px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo-section">
                <div class="logo"></div>
                <div class="title-section">
                    <h1>PocketOption AI</h1>
                    <p id="subtitle">–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –û–¢–°/FX —Å–∏–≥–Ω–∞–ª –Ω–∞ –æ—Å–Ω–æ–≤–µ –ò–ò</p>
                </div>
            </div>
            <div class="lang-badge" id="langBadge">RU</div>
        </div>

        <div class="field">
            <div class="field-label" data-i18n="pair">–ü–ê–†–ê</div>
            <div class="custom-select">
                <div class="select-trigger" id="pairTrigger">
                    <span id="pairSelectedText">üé≤ –†–∞–Ω–¥–æ–º–Ω–∞—è –ø–∞—Ä–∞</span>
                    <svg class="select-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="6 9 12 15 18 9"></polyline>
                    </svg>
                </div>
                <div class="select-dropdown" id="pairDropdown">
                    <!-- Options will be added here by JavaScript -->
                </div>
            </div>
        </div>

        <div class="field">
            <div class="field-label" data-i18n="direction">–ù–ê–ü–†–ê–í–õ–ï–ù–ò–ï</div>
            <div class="field-value placeholder" id="direction">‚Äî</div>
        </div>

        <div class="field">
            <div class="field-label" data-i18n="time">–í–†–ï–ú–Ø</div>
            <div class="field-value placeholder" id="time">
                <span id="timeText">‚Äî</span>
                <span class="timer-badge" id="timerBadge" style="display:none;">
                    <svg class="timer-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14">
                        <circle cx="12" cy="12" r="10"></circle>
                        <polyline points="12 6 12 12 16 14"></polyline>
                    </svg>
                    <span id="timer">00:00</span>
                </span>
            </div>
        </div>

        <div class="field">
            <div class="field-label" data-i18n="status">–°–¢–ê–¢–£–°</div>
            <div class="field-value placeholder" id="status">‚Äî</div>
        </div>

        <button class="button button-primary" id="generateBtn" data-i18n="generateBtn">–ü–æ–ª—É—á–∏—Ç—å —Å–∏–≥–Ω–∞–ª</button>
        <button class="button button-secondary" id="copyBtn" data-i18n="copyBtn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
    </div>

    <script>
        // –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è
        const TRANSLATIONS = {
            ru: {
                subtitle: "–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –û–¢–°/FX —Å–∏–≥–Ω–∞–ª –Ω–∞ –æ—Å–Ω–æ–≤–µ –ò–ò",
                pair: "–ü–ê–†–ê",
                direction: "–ù–ê–ü–†–ê–í–õ–ï–ù–ò–ï",
                time: "–í–†–ï–ú–Ø",
                status: "–°–¢–ê–¢–£–°",
                generateBtn: "–ü–æ–ª—É—á–∏—Ç—å —Å–∏–≥–Ω–∞–ª",
                copyBtn: "–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å",
                randomPair: "–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä—É",
                up: "–í–í–ï–†–•",
                down: "–í–ù–ò–ó",
                inProgress: "–ò–¥—ë—Ç —Å–¥–µ–ª–∫–∞",
                completed: "–ì–æ—Ç–æ–≤–æ",
                generating: "–ì–µ–Ω–µ—Ä–∞—Ü–∏—è...",
                copied: "‚úì –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ",
                copyTemplate: "PocketOption AI –°–∏–≥–Ω–∞–ª\n\n–ü–∞—Ä–∞: {pair}\n–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: {direction}\n–í—Ä–µ–º—è: {time}\n–°—Ç–∞—Ç—É—Å: {status}",
                remaining: "–æ—Å—Ç–∞–ª–æ—Å—å",
                seconds: "—Å–µ–∫—É–Ω–¥",
                minute: "–º–∏–Ω—É—Ç–∞",
                minutes: "–º–∏–Ω—É—Ç—ã",
                timeframes: {
                    30: "30 —Å–µ–∫—É–Ω–¥",
                    60: "1 –º–∏–Ω—É—Ç–∞",
                    90: "1.5 –º–∏–Ω—É—Ç—ã",
                    120: "2 –º–∏–Ω—É—Ç—ã",
                    180: "3 –º–∏–Ω—É—Ç—ã",
                    300: "5 –º–∏–Ω—É—Ç"
                }
            },
            en: {
                subtitle: "Generates OTC/FX signal based on AI",
                pair: "PAIR",
                direction: "DIRECTION",
                time: "TIME",
                status: "STATUS",
                generateBtn: "Get Signal",
                copyBtn: "Copy",
                randomPair: "Generate pair",
                up: "UP",
                down: "DOWN",
                inProgress: "Trade in Progress",
                completed: "Completed",
                generating: "Generating...",
                copied: "‚úì Copied",
                copyTemplate: "PocketOption AI Signal\n\nPair: {pair}\nDirection: {direction}\nTime: {time}\nStatus: {status}",
                remaining: "remaining",
                seconds: "seconds",
                minute: "minute",
                minutes: "minutes",
                timeframes: {
                    30: "30 seconds",
                    60: "1 minute",
                    90: "1.5 minutes",
                    120: "2 minutes",
                    180: "3 minutes",
                    300: "5 minutes"
                }
            }
        };

        // –ü–æ–ª—É—á–µ–Ω–∏–µ —è–∑—ã–∫–∞ –∏–∑ URL –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
        function getLanguageFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            const lang = urlParams.get('language');
            return (lang === 'en' || lang === 'ru') ? lang : 'ru';
        }

        // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —è–∑—ã–∫–∞ –≤ URL
        function setLanguageInURL(lang) {
            const url = new URL(window.location);
            url.searchParams.set('language', lang);
            window.history.pushState({}, '', url);
        }

        // –¢–µ–∫—É—â–∏–π —è–∑—ã–∫
        let currentLanguage = getLanguageFromURL();

        // –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–≤–æ–¥–∞
        function t(key) {
            const keys = key.split('.');
            let value = TRANSLATIONS[currentLanguage];
            
            for (const k of keys) {
                value = value?.[k];
            }
            
            return value || key;
        }

        // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏
        function applyLocalization() {
            document.getElementById('subtitle').textContent = t('subtitle');
            document.getElementById('langBadge').textContent = currentLanguage.toUpperCase();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Å data-i18n
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                el.textContent = t(key);
            });

            // –û–±–Ω–æ–≤–ª—è–µ–º placeholder –¥–ª—è —Ä–∞–Ω–¥–æ–º–Ω–æ–π –ø–∞—Ä—ã
            if (!selectedPair) {
                pairSelectedText.textContent = t('randomPair');
            }

            // –û–±–Ω–æ–≤–ª—è–µ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –µ—Å–ª–∏ –æ–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ
            if (directionEl.textContent === '–í–í–ï–†–•' || directionEl.textContent === 'UP') {
                directionEl.textContent = t('up');
            } else if (directionEl.textContent === '–í–ù–ò–ó' || directionEl.textContent === 'DOWN') {
                directionEl.textContent = t('down');
            }

            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –µ—Å–ª–∏ –æ–Ω —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
            const statusText = statusEl.textContent;
            if (statusText === '–ò–¥—ë—Ç —Å–¥–µ–ª–∫–∞' || statusText === 'Trade in Progress') {
                statusEl.textContent = t('inProgress');
            } else if (statusText === '–ì–æ—Ç–æ–≤–æ' || statusText === 'Completed') {
                statusEl.textContent = t('completed');
            }

            // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è –µ—Å–ª–∏ –æ–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ
            if (timeTextEl.textContent !== '‚Äî') {
                const savedTrade = getCookie('lastTrade');
                if (savedTrade?.timeSeconds) {
                    timeTextEl.textContent = t(`timeframes.${savedTrade.timeSeconds}`);
                }
            }

            // –ü–µ—Ä–µ—Å–æ–∑–¥–∞–µ–º dropdown —Å —É—á–µ—Ç–æ–º –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏
            rebuildPairDropdown();
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —è–∑—ã–∫–∞
        function toggleLanguage() {
            currentLanguage = currentLanguage === 'ru' ? 'en' : 'ru';
            setLanguageInURL(currentLanguage);
            applyLocalization();
        }

        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
        const CONFIG = {
            pairs: [
                "AED/CNY OTC",
                "AUD/CAD OTC",
                "AUD/CHF OTC",
                "AUD/NZD OTC",
                "AUD/USD",
                "AUD/USD OTC",
                "BHD/CNY OTC",
                "CAD/CHF OTC",
                "CAD/JPY OTC",
                "CHF/JPY OTC",
                "EUR/CAD",
                "EUR/JPY",
                "EUR/NZD OTC",
                "EUR/RUB OTC",
                "EUR/USD",
                "EUR/USD OTC",
                "GBP/USD",
                "JOD/CNY OTC",
                "MAD/USD OTC",
                "NZD/USD OTC",
                "OMR/CNY OTC",
                "TND/USD OTC",
                "USD/BDT OTC",
                "USD/CAD OTC",
                "USD/CLP OTC",
                "USD/EGP OTC",
                "USD/PHP OTC",
                "USD/SGD OTC",
                "USD/THB OTC",
                "USD/VND OTC",
                "YER/USD OTC",
                "ZAR/USD OTC",
                "AUD/JPY OTC",
                "USD/IDR OTC",
                "NZD/JPY OTC",
                "EUR/TRY OTC",
                "GBP/CHF",
                "CAD/JPY",
                "LBP/USD OTC",
                "GBP/AUD",
                "USD/CHF OTC",
                "AUD/CHF",
                "SAR/CNY OTC",
                "AUD/CAD",
                "EUR/AUD",
                "AUD/JPY",
                "CAD/CHF",
                "EUR/CHF",
                "EUR/GBP",
                "USD/CHF",
                "USD/JPY",
                "GBP/CAD",
                "USD/ARS OTC",
                "USD/BRL OTC",
                "USD/DZD OTC",
                "USD/PKR OTC",
                "GBP/JPY",
                "NGN/USD OTC",
                "EUR/CHF OTC",
                "GBP/JPY OTC",
                "CHF/NOK OTC",
                "UAH/USD OTC",
                "USD/INR OTC",
                "USD/MXN OTC",
                "CHF/JPY",
                "USD/JPY OTC",
                "USD/CAD",
                "USD/RUB OTC",
                "QAR/CNY OTC",
                "USD/CNH OTC",
                "GBP/AUD OTC",
                "EUR/GBP OTC",
                "KES/USD OTC",
                "USD/COP OTC",
                "EUR/HUF OTC",
                "EUR/JPY OTC",
                "GBP/USD OTC",
                "USD/MYR OTC"
            ],
            
            getDirections: () => [t('up'), t('down')],
            
            // –í—Ä–µ–º–µ–Ω–Ω—ã–µ –æ—Ç—Ä–µ–∑–∫–∏ —Å –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏
            getTimeframes: () => [
                { seconds: 30, label: t('timeframes.30') },
                { seconds: 60, label: t('timeframes.60') },
                { seconds: 180, label: t('timeframes.180') },
                { seconds: 300, label: t('timeframes.300') }
            ]
        };

        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const langBadge = document.getElementById('langBadge');
        const pairTrigger = document.getElementById('pairTrigger');
        const pairDropdown = document.getElementById('pairDropdown');
        const pairSelectedText = document.getElementById('pairSelectedText');
        const directionEl = document.getElementById('direction');
        const timeEl = document.getElementById('time');
        const timeTextEl = document.getElementById('timeText');
        const statusEl = document.getElementById('status');
        const generateBtn = document.getElementById('generateBtn');
        const copyBtn = document.getElementById('copyBtn');
        const timerBadge = document.getElementById('timerBadge');
        const timerEl = document.getElementById('timer');

        let selectedPair = null;
        let countdownInterval;
        let tradeEndTime;

        // –ü–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ dropdown —Å –ø–µ—Ä–µ–≤–æ–¥–æ–º
        function rebuildPairDropdown() {
            pairDropdown.innerHTML = '';
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–ø—Ü–∏—é "–†–∞–Ω–¥–æ–º–Ω–∞—è –ø–∞—Ä–∞"
            const autoOption = document.createElement('div');
            autoOption.className = 'select-option auto';
            autoOption.innerHTML = `<div class="option-icon"></div><span>${t('randomPair')}</span>`;
            autoOption.dataset.value = '';
            pairDropdown.appendChild(autoOption);

            // –î–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ –ø–∞—Ä—ã
            CONFIG.pairs.forEach(pair => {
                const option = document.createElement('div');
                option.className = 'select-option';
                option.innerHTML = `<div class="option-icon"></div><span>${pair}</span>`;
                option.dataset.value = pair;
                
                // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –ø–∞—Ä—É
                if (selectedPair && selectedPair === pair) {
                    option.classList.add('selected');
                }
                
                pairDropdown.appendChild(option);
            });
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è dropdown –¥–ª—è –ø–∞—Ä
        function initPairDropdown() {
            rebuildPairDropdown();

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è dropdown
            pairTrigger.addEventListener('click', (e) => {
                e.stopPropagation();
                pairTrigger.classList.toggle('active');
                pairDropdown.classList.toggle('active');
            });

            // –ó–∞–∫—Ä—ã—Ç–∏–µ dropdown –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
            document.addEventListener('click', (e) => {
                if (!pairTrigger.contains(e.target) && !pairDropdown.contains(e.target)) {
                    pairTrigger.classList.remove('active');
                    pairDropdown.classList.remove('active');
                }
            });

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±–æ—Ä–∞ –æ–ø—Ü–∏–∏
            pairDropdown.addEventListener('click', (e) => {
                const option = e.target.closest('.select-option');
                if (!option) return;

                // –£–±–∏—Ä–∞–µ–º –∫–ª–∞—Å—Å selected —É –≤—Å–µ—Ö –æ–ø—Ü–∏–π
                pairDropdown.querySelectorAll('.select-option').forEach(opt => {
                    opt.classList.remove('selected');
                });

                // –î–æ–±–∞–≤–ª—è–µ–º selected –∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –æ–ø—Ü–∏–∏
                option.classList.add('selected');

                // –û–±–Ω–æ–≤–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
                selectedPair = option.dataset.value;
                pairSelectedText.textContent = option.querySelector('span').textContent;

                // –ó–∞–∫—Ä—ã–≤–∞–µ–º dropdown
                pairTrigger.classList.remove('active');
                pairDropdown.classList.remove('active');
            });
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å cookies
        function setCookie(name, value, days) {
            const expires = new Date();
            expires.setTime(expires.getTime() + days * 24 * 60 * 60 * 1000);
            document.cookie = `${name}=${JSON.stringify(value)};expires=${expires.toUTCString()};path=/`;
        }

        function getCookie(name) {
            const nameEQ = name + "=";
            const ca = document.cookie.split(';');
            for(let i = 0; i < ca.length; i++) {
                let c = ca[i];
                while (c.charAt(0) === ' ') c = c.substring(1, c.length);
                if (c.indexOf(nameEQ) === 0) {
                    try {
                        return JSON.parse(c.substring(nameEQ.length, c.length));
                    } catch {
                        return null;
                    }
                }
            }
            return null;
        }

        // –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –∏–∑ –º–∞—Å—Å–∏–≤–∞
        function getRandomItem(array) {
            return array[Math.floor(Math.random() * array.length)];
        }

        // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
        function formatTimer(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${String(mins).padStart(2, '0')}:${String(secs).padStart(2, '0')}`;
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ label –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –æ—Ç—Ä–µ–∑–∫–∞
        function getTimeframeLabel(seconds) {
            return t(`timeframes.${seconds}`) || `${seconds} ${t('seconds')}`;
        }

        // –û–±—Ä–∞—Ç–Ω—ã–π –æ—Ç—Å—á–µ—Ç
        function startCountdown(duration) {
            // clear any existing
            if (countdownInterval) {
                clearInterval(countdownInterval);
            }

            tradeEndTime = Date.now() + duration * 1000;
            timerBadge.style.display = 'inline-flex';
            statusEl.textContent = t('inProgress');
            statusEl.classList.remove('placeholder');
            generateBtn.disabled = true;

            // –Ω–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
            timerEl.textContent = formatTimer(duration);

            countdownInterval = setInterval(() => {
                const remaining = Math.max(0, Math.floor((tradeEndTime - Date.now()) / 1000));
                timerEl.textContent = formatTimer(remaining);

                if (remaining <= 0) {
                    clearInterval(countdownInterval);
                    timerBadge.style.display = 'none';
                    statusEl.textContent = t('completed');
                    statusEl.classList.remove('placeholder');
                    generateBtn.disabled = false;
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –≤ cookies
                    const savedTrade = getCookie('lastTrade');
                    if (savedTrade) {
                        savedTrade.status = t('completed');
                        setCookie('lastTrade', savedTrade, 7);
                    }
                }
            }, 1000);
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–∞
        function generateSignal() {
            const pair = selectedPair || getRandomItem(CONFIG.pairs);
            const direction = getRandomItem(CONFIG.getDirections());
            const timeframe = getRandomItem(CONFIG.getTimeframes());

            const trade = {
                pair: pair,
                direction: direction,
                timeSeconds: timeframe.seconds,
                timeLabel: timeframe.label,
                status: t('inProgress'),
                endTime: Date.now() + timeframe.seconds * 1000
            };

            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ cookies
            setCookie('lastTrade', trade, 7);

            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
            directionEl.textContent = direction;
            directionEl.classList.remove('placeholder');
            
            timeTextEl.textContent = timeframe.label;
            timeTextEl.classList.remove('placeholder');

            // –û–±–Ω–æ–≤–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –ø–∞—Ä—É –≤ dropdown, –µ—Å–ª–∏ –±—ã–ª–∞ —Ä–∞–Ω–¥–æ–º–Ω–∞—è
            if (!selectedPair) {
                pairSelectedText.textContent = pair;
            }

            // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä
            startCountdown(timeframe.seconds);
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å –∏–º–∏—Ç–∞—Ü–∏–µ–π –∑–∞–≥—Ä—É–∑–∫–∏
        function handleGenerate() {
            const originalText = generateBtn.textContent;
            generateBtn.disabled = true;
            generateBtn.innerHTML = `<span class="spinner"></span>${t('generating')}`;

            // –∏–º–∏—Ç–∏—Ä—É–µ–º –∑–∞–≥—Ä—É–∑–∫—É
            setTimeout(() => {
                generateSignal();
                generateBtn.textContent = originalText;
            }, 1200);
        }

        // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
        function copyToClipboard() {
            const savedTrade = getCookie('lastTrade');
            const pair = selectedPair || savedTrade?.pair || t('randomPair');
            const direction = directionEl.textContent;
            const timeDisplay = timeTextEl.textContent === '‚Äî' ? '‚Äî' : `${timeTextEl.textContent} ${timerBadge.style.display !== 'none' ? `(${timerEl.textContent} ${t('remaining')})` : ''}`;
            const status = statusEl.textContent;

            const text = t('copyTemplate')
                .replace('{pair}', pair)
                .replace('{direction}', direction)
                .replace('{time}', timeDisplay)
                .replace('{status}', status);

            navigator.clipboard.writeText(text).then(() => {
                const originalText = copyBtn.textContent;
                copyBtn.textContent = t('copied');
                setTimeout(() => {
                    copyBtn.textContent = originalText;
                }, 2000);
            });
        }

        // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        function restoreLastTrade() {
            const savedTrade = getCookie('lastTrade');
            if (savedTrade) {
                const timeRemaining = Math.max(0, Math.floor((savedTrade.endTime - Date.now()) / 1000));

                if (savedTrade.pair) {
                    selectedPair = savedTrade.pair;
                    pairSelectedText.textContent = savedTrade.pair;
                    
                    // –ü–æ–º–µ—á–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –æ–ø—Ü–∏—é –≤ dropdown
                    pairDropdown.querySelectorAll('.select-option').forEach(opt => {
                        if (opt.dataset.value === savedTrade.pair) {
                            opt.classList.add('selected');
                        }
                    });
                }
                
                if (savedTrade.direction) {
                    // –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–∞ –ª—é–±–æ–º —è–∑—ã–∫–µ, –æ—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∫ –µ—Å—Ç—å
                    directionEl.textContent = savedTrade.direction;
                    directionEl.classList.remove('placeholder');
                }

                if (savedTrade.timeSeconds) {
                    timeTextEl.textContent = getTimeframeLabel(savedTrade.timeSeconds);
                    timeTextEl.classList.remove('placeholder');
                }

                if (timeRemaining > 0) {
                    startCountdown(timeRemaining);
                } else {
                    // –µ—Å–ª–∏ —Å–¥–µ–ª–∫–∞ —É–∂–µ –∑–∞–∫–æ–Ω—á–µ–Ω–∞
                    timerBadge.style.display = 'none';
                    statusEl.textContent = t('completed');
                    statusEl.classList.remove('placeholder');
                }
            }
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        generateBtn.addEventListener('click', handleGenerate);
        copyBtn.addEventListener('click', copyToClipboard);
        langBadge.addEventListener('click', toggleLanguage);

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        applyLocalization();
        initPairDropdown();
        restoreLastTrade();
    </script>
</body>
</html>
